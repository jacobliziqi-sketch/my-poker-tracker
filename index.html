<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PokerFlow Pro - 实战高频版</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #070b14; color: #e2e8f0; font-family: sans-serif; overflow-x: hidden; }
        .poker-table { background: radial-gradient(circle, #1a4d2e 0%, #0a2615 100%); border: 8px solid #3d2b1f; border-radius: 200px; position: relative; height: 300px; width: 100%; margin: 20px 0; }
        .player-slot { position: absolute; transform: translate(-50%, -50%); text-align: center; width: 60px; }
        .card-btn { @apply w-8 h-10 flex items-center justify-center rounded text-sm font-bold shadow-sm active:scale-90 transition-all; border: 1px solid rgba(255,255,255,0.1); }
        .suit-s { background: #fff; color: #000; } .suit-h { background: #fff; color: #ff4444; }
        .suit-d { background: #fff; color: #3b82f6; } .suit-c { background: #fff; color: #22c55e; }
        .hud-tag { font-size: 8px; @apply px-1 rounded bg-black/50 text-emerald-400 font-mono; }
    </style>
</head>
<body class="p-2">
    <div class="poker-table shadow-2xl">
        <div id="tablePlayers"></div>
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-center">
            <div class="text-[10px] text-gray-400 uppercase tracking-widest">Total Pot</div>
            <div id="potDisplay" class="text-2xl font-black text-yellow-400 font-mono">0</div>
        </div>
    </div>

    <div id="pokerKeyboard" class="bg-slate-900 rounded-t-3xl p-3 fixed bottom-0 left-0 right-0 shadow-2xl border-t border-slate-700 hidden z-50">
        <div class="flex justify-between mb-2 px-2">
            <span class="text-xs font-bold">选择手牌</span>
            <button onclick="closeKeyboard()" class="text-blue-400 text-xs">确定</button>
        </div>
        <div class="grid grid-cols-13 gap-1 overflow-x-auto pb-2" id="cardsGrid">
            </div>
    </div>

    <div class="grid grid-cols-4 gap-2 mb-4">
        <button onclick="recordAction('Fold')" class="bg-slate-700 py-3 rounded-xl text-xs font-bold">FOLD</button>
        <button onclick="recordAction('Call')" class="bg-blue-600 py-3 rounded-xl text-xs font-bold">CALL</button>
        <button onclick="recordAction('Raise')" class="bg-emerald-600 py-3 rounded-xl text-xs font-bold">RAISE</button>
        <button onclick="openKeyboard()" class="bg-indigo-600 py-3 rounded-xl text-xs font-bold">CARDS</button>
    </div>

    <div class="bg-slate-800 rounded-xl p-3">
        <h3 class="text-[10px] font-bold text-slate-500 mb-2">SESSION HUD (实时数据)</h3>
        <div id="hudList" class="space-y-2"></div>
    </div>

    <script>
        const positions = [
            {id: 'SB', x: '50%', y: '90%'}, {id: 'BB', x: '20%', y: '80%'},
            {id: 'UTG', x: '10%', y: '50%'}, {id: 'HJ', x: '25%', y: '20%'},
            {id: 'CO', x: '75%', y: '20%'}, {id: 'BTN', x: '90%', y: '50%'}
        ];

        let stats = JSON.parse(localStorage.getItem('poker_stats') || '{}');
        let currentHand = [];

        function init() {
            // 生成牌桌玩家
            const table = document.getElementById('tablePlayers');
            positions.forEach(pos => {
                if(!stats[pos.id]) stats[pos.id] = { hands: 0, vpip: 0, pfr: 0, total: 0 };
                const s = stats[pos.id];
                const vpip = s.total > 0 ? Math.round((s.vpip / s.total) * 100) : 0;
                
                table.innerHTML += `
                    <div class="player-slot" style="left:${pos.x}; top:${pos.y}">
                        <div class="text-[9px] font-bold text-slate-400">${pos.id}</div>
                        <div class="w-10 h-10 rounded-full bg-slate-700 border-2 border-slate-500 mx-auto flex items-center justify-center text-[10px]">P</div>
                        <div class="hud-tag">V:${vpip}%</div>
                    </div>
                `;
            });

            // 生成52张牌键盘
            const grid = document.getElementById('cardsGrid');
            const suits = [{s:'s', n:'♠'}, {s:'h', n:'♥'}, {s:'d', n:'♦'}, {s:'c', n:'♣'}];
            const ranks = ['A','K','Q','J','T','9','8','7','6','5','4','3','2'];
            
            suits.forEach(suit => {
                ranks.forEach(rank => {
                    grid.innerHTML += `
                        <button onclick="selectCard('${rank}${suit.s}')" class="card-btn suit-${suit.s}">${rank}</button>
                    `;
                });
            });
        }

        function openKeyboard() { document.getElementById('pokerKeyboard').classList.remove('hidden'); }
        function closeKeyboard() { document.getElementById('pokerKeyboard').classList.add('hidden'); }

        function selectCard(card) {
            currentHand.push(card);
            if(currentHand.length > 2) currentHand.shift();
            console.log("Selected:", currentHand);
        }

        function recordAction(type) {
            // 简单的统计逻辑模拟
            // 每一手牌你点击 Raise，对应的位置 PFR 就会上升
            alert(type + " 已记录。数据正在实时更新 HUD...");
        }

        init();
    </script>
</body>
</html>